{% extends "base.html" %}

{% block title %}Dashboard - File Share Bot Admin{% endblock %}

{% block content %}
<div class="min-h-screen p-8">
    <h1 class="text-3xl font-bold mb-8">ðŸ“Š Dashboard</h1>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="bg-dark-card p-6 rounded-lg border border-dark-border">
            <h3 class="text-gray-400 text-sm font-medium mb-2">Total Users</h3>
            <p class="text-3xl font-bold" id="total-users">-</p>
        </div>
        <div class="bg-dark-card p-6 rounded-lg border border-dark-border">
            <h3 class="text-gray-400 text-sm font-medium mb-2">Active (24h)</h3>
            <p class="text-3xl font-bold text-green-400" id="active-users">-</p>
        </div>
        <div class="bg-dark-card p-6 rounded-lg border border-dark-border">
            <h3 class="text-gray-400 text-sm font-medium mb-2">Total Files</h3>
            <p class="text-3xl font-bold" id="total-files">-</p>
        </div>
        <div class="bg-dark-card p-6 rounded-lg border border-dark-border">
            <h3 class="text-gray-400 text-sm font-medium mb-2">Storage Used</h3>
            <p class="text-3xl font-bold text-blue-400" id="storage-used">-</p>
        </div>
    </div>

    <div class="bg-dark-card p-6 rounded-lg border border-dark-border">
        <h2 class="text-xl font-bold mb-4">ðŸ”¥ Top Files</h2>
        <div id="top-files"></div>
    </div>
</div>

<script>
    async function loadStats() {
        const token = document.cookie.split('access_token=')[1];
        const response = await fetch('/api/stats', {
            headers: {'Authorization': token}
        });
        const stats = await response.json();
        
        document.getElementById('total-users').textContent = stats.total_users;
        document.getElementById('active-users').textContent = stats.active_24h;
        document.getElementById('total-files').textContent = stats.total_files;
        document.getElementById('storage-used').textContent = stats.storage_human;
        
        const topFiles = document.getElementById('top-files');
        topFiles.innerHTML = stats.top_files.map((f, i) => 
            `<div class="flex justify-between py-2 border-b border-dark-border">
                <span>${i+1}. ${f.file_name}</span>
                <span class="text-gray-400">${f.downloads} downloads</span>
            </div>`
        ).join('');
    }
    
    loadStats();
</script>
{% endblock %}
